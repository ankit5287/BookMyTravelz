<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book</title>

    <!-- swiper css link  -->
    <link rel="stylesheet" href="https://unpkg.com/swiper@7/swiper-bundle.min.css" />

    <!-- font awesome cdn link  -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

    <!-- custom css file link  -->
    <link rel="stylesheet" href="css/style.css?v=" type="text/css">
</head>

<body>
    <!-- Header Section Start -->
    <section class="header">
        <a href="index.html" class="logo">PlanMyTrip</a>

        <nav class="navbar">
            <a href="index.html">Home</a>
            <a href="about.html">About</a>
            <a href="package.html">Package</a>
            <a href="book.html">Book</a>
            <a href="status.html">Booking Status</a>
        </nav>

        <div id="menu-btn" class="fas fa-bars"></div>
    </section>
    <!-- Header Section End -->
    <!-- Book Section Start-->
    <div class="heading" style="background: url(images/book-header.jpg) no-repeat">
        <h1>book now</h1>
    </div>

    <section class="booking">
        <h1 class="heading-title">book your trip!</h1>

        <form id="bookingForm" class="book-form">
            <div class="flex">
                <div class="inputBox">
                    <span>name :</span>
                    <input type="text" placeholder="enter your name" name="name" required>
                </div>

                <div class="inputBox">
                    <span>Email:</span>
                    <input type="email" placeholder="Enter your email" name="email" required>
                </div>

                <div class="inputBox">
                    <span>Phone:</span>
                    <input type="number" placeholder="Enter your number" name="phone" required>
                </div>

                <div class="inputBox">
                    <span>Address:</span>
                    <input type="text" placeholder="Enter your address" name="address" required>
                </div>

                <div class="inputBox">
                    <span>Destination:</span>
                    <input type="text" placeholder="Place you want to visit" name="location" required>
                </div>

                <div class="inputBox">
                    <span>Number of Guests:</span>
                    <input type="number" placeholder="Number of guests" name="guests" required>
                </div>

                <div class="inputBox">
                    <span>Arrival Date:</span>
                    <input type="date" name="arrivals" required>
                </div>

                <div class="inputBox">
                    <span>Departure Date:</span>
                    <input type="date" name="leaving" required>
                </div>
            </div>

            <input type="submit" value="Submit Request" class="btn" name="send">
        </form>

        <script>
            document.getElementById('bookingForm').addEventListener('submit', async function (e) {
                e.preventDefault();

                const formData = new FormData(this);
                const data = Object.fromEntries(formData.entries());

                try {
                    const response = await fetch('/api/book', {
                        method: 'POST',
                        headers: {
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify(data)
                    });

                    const result = await response.json();

                    if (result.success) {
                        // Success modal logic
                        const modal = document.getElementById('success-modal');
                        const customerIdSpan = document.getElementById('new-customer-id');
                        customerIdSpan.innerText = result.customerId;
                        modal.style.display = 'flex';

                        this.reset();
                    } else {
                        alert('Error: ' + result.message);
                    }
                } catch (error) {
                    console.error('Error:', error);
                    alert('Something went wrong. Please try again.');
                }
            });

            function copyToClipboard() {
                const idText = document.getElementById('new-customer-id').innerText;
                navigator.clipboard.writeText(idText).then(() => {
                    const icon = document.getElementById('copy-icon');
                    // distinct visual feedback
                    icon.classList.remove('fa-copy');
                    icon.classList.add('fa-check');
                    icon.style.color = 'green';

                    setTimeout(() => {
                        icon.classList.remove('fa-check');
                        icon.classList.add('fa-copy');
                        icon.style.color = 'var(--main-color)';
                    }, 2000);
                });
            }

            function closeSuccessModal() {
                document.getElementById('success-modal').style.display = 'none';
            }
        </script>

        <!-- Success Modal -->
        <div id="success-modal" class="package-modal" style="display: none;">
            <div class="modal-content" style="text-align: center;">
                <span class="close-btn" onclick="closeSuccessModal()">&times;</span>
                <h3 style="color: var(--main-color); margin-bottom: 1rem;">Booking Confirmed!</h3>
                <p style="color: #333; font-size: 1.6rem; margin-bottom: 2rem;">Thank you for booking with us. Your
                    unique Customer ID is:</p>
                <div style="display: flex; align-items: center; justify-content: center; gap: 1rem; margin: 1.5rem 0;">
                    <h2 id="new-customer-id"
                        style="color: #333; border: 2px dashed var(--main-color); padding: 0.5rem 1rem; margin: 0;">
                    </h2>
                    <i id="copy-icon" class="fas fa-copy" onclick="copyToClipboard()"
                        style="font-size: 2rem; color: var(--main-color); cursor: pointer;"
                        title="Copy to clipboard"></i>
                </div>
            </div>
        </div>
    </section>
    <!-- Book Section End-->

    <!-- Package Modal -->
    <div class="package-modal" id="package-modal" style="display: none;">
        <div class="modal-content">
            <span class="close-btn" id="close-modal">&times;</span>
            <img id="modal-img" src="" alt=""
                style="width: 100%; height: 25rem; object-fit: cover; border-radius: 1rem; margin-bottom: 2rem; display: none;">
            <h3 id="modal-title"></h3>
            <div id="modal-body"></div>
        </div>
    </div>
    <!-- Package Modal End -->

    <!-- Footer Section Start -->
    <section class="footer">
        <div class="box-container">
            <div class="box">
                <h3>quick links</h3>
                <a href="index.html"><i class="fas fa-angle-right"></i> Home</a>
                <a href="about.html"><i class="fas fa-angle-right"></i>About</a>
                <a href="package.html"><i class="fas fa-angle-right"></i>Package</a>
                <a href="book.html"><i class="fas fa-angle-right"></i>Book</a>
            </div>

            <div class="box">
                <h3>extra links</h3>
                <a href="#" data-key="questions"><i class="fas fa-angle-right"></i>ask questions</a>
                <a href="#" data-key="about"><i class="fas fa-angle-right"></i>about us</a>
                <a href="#" data-key="privacy"><i class="fas fa-angle-right"></i>privacy policy</a>
                <a href="#" data-key="terms"><i class="fas fa-angle-right"></i>terms of use</a>
            </div>

            <div class="box">
                <h3>contact info</h3>
                <a href="#"><i class="fas fa-phone"></i>+91 7801974180</a>
                <a href="#"><i class="fas fa-envelope"></i>formicro32@gmail.com</a>
                <a href="#"><i class="fas fa-map"></i>Ahmedabad, India</a>
            </div>

            <div class="box">
                <h3>follow us</h3>
                <a href="#"><i class="fab fa-facebook-f"></i>facebook</a>
                <a href="#"><i class="fab fa-twitter"></i>twitter</a>
                <a href="#"><i class="fab fa-instagram"></i>instagram</a>
                <a href="#"><i class="fab fa-linkedin"></i>linkedin</a>
            </div>
        </div>
    </section>
    <!-- Footer Section End -->
    <!-- swiper js link  -->
    <script src="https://unpkg.com/swiper@7/swiper-bundle.min.js"></script>
    <!-- custom js file link  -->
    <script type="text/javascript" src="js/script.js?v="></script>
</body>

</html>